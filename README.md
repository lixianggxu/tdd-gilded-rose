# TDD @Gilded Rose


## 开发环境
 - JDK1.8+
 
## 业务需求

"镶金玫瑰"！这是一家魔兽世界里的小商店。出售的商品也都是高质量的。但不妙的是，随着商品逐渐接近保质期，它们的质量也不断下滑。我们用一个IT系统来更新库存信息。

首先，简单介绍一下我们的系统：

- 所有商品都有一个`SellIn`值，这是商品距离过期的天数，最好在这么多天之内卖掉
- 所有商品都有一个`Quality`值，代表商品的价值
- 商品的`SellIn`值和`Quality`值，它们每天会发生变化，但是会有特例


商品的价格规则说明如下：

- 商品的价值永远不会小于0，也永远不会超过50：一般商品 保质期内，每天价值下降1点；
- 一旦过了保质期，`Quality`就以双倍的速度下滑
- 陈年干酪（`Aged Brie`）是一种特殊的商品，放得越久，价值反而越高：保质期内，每天价值上升1点，过了保质期，每天上升2点；
- 萨弗拉斯（`Sulfuras`）是一种传奇商品，没有保质期的概念，价值也不会下滑
- 后台门票（`Backstage pass`）和陈年干酪（`Aged Brie`）有相似之处：
	- 越接近演出日，商品的价值反而上升
	- 在演出前10天，价值每天上升2点（前6天～前10天，按照2个点）
	- 演出前5天，价值每天上升3点（前5天——前1天，3个点）
	- 一旦过了演出日，价值就马上变成0

 
商品属性：
SellIn,还剩下的保质期
Quality,商品当前价值
增长，减少点价值；



问题：
一般商品，在保质期内商品价值是不变的？过了保质期后，价值双倍速率下降；
陈内干酪没有保质期，每天它的价值会增加，如何增长，增加多少我们自己定？比如数是按倍数增长还是按点数增长。



##tasking:

### scenario 一般商品:过保质期，价值下滑。 
#### 一般商品过保质期后，价值才降为0。
case1: 在保质期当中
Given 普通商品当前价值=30，剩余保质期=10
When  1天过去
Then 此时，商品价值=29，剩余保质期=9

case2: 刚好过期
Given 普通商品当前价值=30，剩余保质期=10
When  10天过去
Then 此时，商品价值=20，剩余保质期=0

case3: 过保质期，且价值大于0
Given 普通商品当前价值=30，剩余保质期=10
When 11天过去
Then 此时，商品价值=18，剩余保质期=-1

case4: 过保质期，且价值刚好为0
Given 普通商品当前价值=30，剩余保质期=10
When 30天过去
Then 此时，商品价值=0，剩余保质期= -20

case5: 过保质期，且价值一直维持0
Given 普通商品当前价值=30，剩余保质期=10
When 31天过去
Then 此时，商品价值=0，剩余保质期= -21

#### 一般商品过未过期时价值就降为0了。
case6: 保质期内，价值就刚好降为0
Given 普通B商品价值=10，剩余保质期=20
When 10 天过去
Then 此时，商品价值=0，剩余保质期=10

case7: 保质期内，价值已为0后
Given 普通B商品价值=10，剩余保质期=20
When  15 天过去
Then 此时，商品价值=0，剩余保质期=5

case7: 过保质期后
Given 普通B商品价值=10，剩余保质期=20
When  21 天过去
Then 此时，商品价值=0，剩余保质期=-1

#### 一般商品过过期时，价值刚好降为0。
case8: 在保质期内
Given 普通C商品价值=10，剩余保质期=10
When  1 天过去
Then 此时，商品价值=9，剩余保质期=9

case9: 刚好过期了
Given 普通C商品价值=10，剩余保质期=10
When  10 天过去
Then 此时，商品价值=0，剩余保质期=0

case10: 已经过期
Given 普通C商品价值=10，剩余保质期=10
When  11 天过去
Then 此时，商品价值=0，剩余保质期= -1



### scenario 似 陈年干酪 商品类型： 越放越久，价值越高；
#### 在保质内，价值已超过50
case1: 在保质期内，且价值未超过50
Given 陈年干酪当前价值=30，剩余保质期=30
When 1天过去
Then 此时，陈年干酪价值=31，剩余保质期=29

case2: 在保质期内，且价值为50
Given 陈年干酪当前价值=30，剩余保质期=30
When 20天过去
Then 此时 陈年干酪价值=50，剩余保质期=10

case3: 在保质期内，且价值为50后
Given 陈年干酪当前价值=30，剩余保质期=30
When 21天过去
Then 此时 陈年干酪价值=50，剩余保质期=9

case4: 刚过保质期
Given 陈年干酪当前价值=30，剩余保质期=30
When 30天过去
Then 此时 陈年干酪价值=50，剩余保质期=0

case5: 过保质期
Given 陈年干酪当前价值=30，剩余保质期=30
When 31天过去
Then 此时 陈年干酪价值=50，剩余保质期=-1

#### 在保质期内，价值未超过50
case6: 在保质期内，且价值未超出50
Given 陈年干酪B当前价值=10，剩余保质期=10
When 1天过去
Then 此时 陈年干酪价值=11，剩余保质期=1

case7: 刚过保质期，且价值未超出50
Given 陈年干酪B当前价值=10，剩余保质期=10
When 10天过去
Then 此时 陈年干酪价值=20，剩余保质期=0

case8: 已过保质期，且价值刚刚为50
Given 陈年干酪B当前价值=10，剩余保质期=10
When 25天过去
Then 此时 陈年干酪价值=50，剩余保质期=-15

case9: 已过保质期，且价值已为50
Given 陈年干酪B当前价值=10，剩余保质期=10
When 26天过去
Then 此时 陈年干酪价值=50，剩余保质期=-16

#### 刚好过期时，价值也刚好为50
case10: 在保质期内，且价值未超出50
Given 陈年干酪C当前价值=40，剩余保质期=10
When 1天过去
Then 此时 陈年干酪价值=41，剩余保质期=9

case11: 刚过保质期，价值刚好为50
Given 陈年干酪C当前价值=40，剩余保质期=10
When 10天过去
Then 此时 陈年干酪价值=50，剩余保质期=0

case12: 过了保质期，价值刚已为50
Given 陈年干酪C当前价值=40，剩余保质期=10
When 11天过去
Then 此时 陈年干酪价值=50，剩余保质期=-1

### scenario 似 萨弗拉斯 商品类型：没有保质期，价值不会下滑；
#### 初始化价值不为0，也不为50；
case1: 在保质期内，价值不变，保质期变
Given 萨弗拉斯A当前价值=30，保质期=10
When  1过去
Then 此时，萨弗拉斯A=30，保质期=9

case2: 刚过保质期，价值不变，保质期变
Given 萨弗拉斯A当前价值=30，保质期=10
When  10过去
Then 此时，萨弗拉斯A=30，保质期=0

case3: 已过保质期，价值不变，保质期变
Given 萨弗拉斯A当前价值=30，保质期=10
When  11过去
Then 此时，萨弗拉斯A=30，保质期=-1

#### 初始化价值为0；
case4: 在保质期内，价值不变，保质期变
Given 萨弗拉斯B当前价值=0，保质期=10
When  1过去
Then 此时，萨弗拉斯B=0，保质期=9

case5: 刚过保质期，价值不变，保质期变
Given 萨弗拉斯B当前价值=0，保质期=10
When  10过去
Then 此时，萨弗拉斯B=0，保质期=0

case6: 已过保质期，价值不变，保质期变
Given 萨弗拉斯B当前价值=0，保质期=10
When  11过去
Then 此时，萨弗拉斯B=0，保质期=-1

#### 初始化价值为50；
case7: 在保质期内，价值不变，保质期变
Given 萨弗拉斯C当前价值=50，保质期=10
When  1过去
Then 此时，萨弗拉斯C=50，保质期=9

case8: 刚过保质期，价值不变，保质期变
Given 萨弗拉斯C当前价值=50，保质期=10
When  10过去
Then 此时，萨弗拉斯C=50，保质期=0

case9: 已过保质期，价值不变，保质期变
Given 萨弗拉斯C当前价值=50，保质期=10
When  11过去
Then 此时，萨弗拉斯C=50，保质期=-1



### scenario 似 门票和干酪 商品类型：接近演出时间，价值梯度上升，演出完后，价值为0；
#### 在演出前，价值未超过50
case1: 演出前20天
Given 后面门票当前价值=2，剩余保质期=20
When  1天过去
Then 此时，商品价值=3，剩余保质期=19

case2: 刚好演出前11天
Given 后面门票当前价值=2，剩余保质期=20
When  10天过去
Then 此时，商品价值=12，剩余保质期=10

case3: 刚好演出前10天
Given 后面门票当前价值=2，剩余保质期=20
When  11天过去
Then 此时，商品价值=14，剩余保质期=9

case4: 刚好演出前6天
Given 后面门票当前价值=2，剩余保质期=20
When  15天过去
Then 此时，商品价值=22，剩余保质期=5

case5: 刚好演出前5天
Given 后面门票当前价值=2，剩余保质期=20
When  16天过去
Then 此时，商品价值=25，剩余保质期=4

case6: 刚好演出前1天
Given 后面门票当前价值=2，剩余保质期=20
When  19天过去
Then 此时，商品价值=34，剩余保质期=1

case7: 演出当天
Given 后面门票当前价值=2，剩余保质期=20
When  20天过去
Then 此时，商品价值=0，剩余保质期=0

case6: 过期了
Given 后面门票当前价值=2，剩余保质期=20
When  21天过去
Then 此时，商品价值=0，剩余保质期=-1

#### 演出前10几天内 价值已超过50
case7: 演出前20天
Given 后面门票B当前价值=40，剩余保质期=21
When  1天过去
Then 此时，商品价值=41，剩余保质期=20

case9: 前11，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  10天过去
Then 此时，商品价值=50，剩余保质期=11

case10: 前10，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  11天过去
Then 此时，商品价值=50，剩余保质期=10

case11: 前6天，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  15天过去
Then 此时，商品价值=50，剩余保质期=6

case12: 前5天，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  16天过去
Then 此时，商品价值=50，剩余保质期=5

case13: 1天前，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  20天过去
Then 此时，商品价值=50，剩余保质期=1

case14: 演出当天，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  21天过去
Then 此时，商品价值=0，剩余保质期=0

case15: 演出过后，价值已为50
Given 后面门票B当前价值=40，剩余保质期=21
When  22天过去
Then 此时，商品价值=0，剩余保质期=-1

#### 演出前10天内 价值已超过50
case16: 演出前20天
Given 后面门票C当前价值=35，剩余保质期=21
When  1天过去
Then 此时，商品价值=36，剩余保质期=20

case17: 前11天，价值没有为50
Given 后面门票C当前价值=35，剩余保质期=21
When  10天过去
Then 此时，商品价值=45，剩余保质期=11

case18: 前10天，价值没有为50
Given 后面门票C当前价值=35，剩余保质期=21
When  11天过去
Then 此时，商品价值=47，剩余保质期=10

case19: 前8天，价值刚好为50
Given 后面门票C当前价值=35，剩余保质期=21
When  13天过去
Then 此时，商品价值=50，剩余保质期=8

case20: 前6天，价值已为50
Given 后面门票C当前价值=35，剩余保质期=21
When  15天过去
Then 此时，商品价值=50，剩余保质期=6

case21: 前5天，价值已为50
Given 后面门票C当前价值=35，剩余保质期=21
When  16天过去
Then 此时，商品价值=50，剩余保质期=5

case22: 1天前，价值已为50
Given 后面门票C当前价值=35，剩余保质期=21
When  20天过去
Then 此时，商品价值=50，剩余保质期=1

case23: 演出当天，价值已为50
Given 后面门票C当前价值=35，剩余保质期=21
When  21天过去
Then 此时，商品价值=0，剩余保质期=0

case24: 演出过后，价值已为50
Given 后面门票C当前价值=35，剩余保质期=21
When  22天过去
Then 此时，商品价值=0，剩余保质期=-1

#### 演出前5天内，价值已超过50
case25: 演出前20天
Given 后面门票D当前价值=25，剩余保质期=21
When  1天过去
Then 此时，商品价值=26，剩余保质期=20

case26: 前11天，价值没有为50
Given 后面门票D当前价值=25，剩余保质期=21
When  10天过去
Then 此时，商品价值=35，剩余保质期=11

case27: 前10天，价值没有为50
Given 后面门票D当前价值=25，剩余保质期=21
When  11天过去
Then 此时，商品价值=37，剩余保质期=10

case28: 前6天，价值没有为50
Given 后面门票D当前价值=25，剩余保质期=21
When  15天过去
Then 此时，商品价值=45，剩余保质期=6

case29: 前5天，价值没有为50
Given 后面门票D当前价值=25，剩余保质期=21
When  16天过去
Then 此时，商品价值=48，剩余保质期=5

case30: 前4天，价值刚为50
Given 后面门票D当前价值=25，剩余保质期=21
When  17天过去
Then 此时，商品价值=50，剩余保质期=4

case31: 1天前，价值已为50
Given 后面门票D当前价值=25，剩余保质期=21
When  20天过去
Then 此时，商品价值=50，剩余保质期=1

case32: 演出当天，价值已为50
Given 后面门票D当前价值=25，剩余保质期=21
When  21天过去
Then 此时，商品价值=0，剩余保质期=0

case33: 演出过后，价值已为50
Given 后面门票D当前价值=25，剩余保质期=21
When  22天过去
Then 此时，商品价值=0，剩余保质期=-1
